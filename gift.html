<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <title>礼品管理 - 易用联友积分管理系统</title>
  <meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0" />
  <link rel="stylesheet" href="css/base.css" />
  <link rel="stylesheet" href="css/bootstrap.min.css" />
  <link href="img/favicon.ico" rel="shortcut icon">
<body>
<!--顶部导航条-->
<script src="head.html"></script>
<section class="container">
  <div class="row">
    <ol class="breadcrumb">
      <li class="active">积分管理系统</li>
      <li class="active">积分兑换</li>
      <li><a href="">礼品管理</a></li>
    </ol>
  </div>
  <div class="row" id="gift-container">
    <div class="gift-box">
      <img class="gift-img col-md-5" src="img/gift1.jpg">
      <div class="col-md-7 gift-info">
        <p>名称：雨伞</p>
        <p>积分：50</p>
        <p class="gift-dsp">描述：雨伞一把，送给敌人最好的礼物。你若不举，便是晴天。</p>
        <div class="gift-btn">
          <input type="button" class="btn btn-danger" value="删除" data-id="3">
          <input type="button" class="btn btn-success" value="编辑" data-id="1">
          <div class="clear"></div>
        </div>
      </div>
      <div class="clear"></div>
    </div>
  </div>
  <div class="row tb-toolbar">
    <input type="button" class="btn btn-primary" value="新增" data-toggle="modal" data-target="#add-modal"/>
    <ul class="pagination">
      <li>
        <a href="#" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      <li><a href="#">1</a></li>
      <li>
        <a href="#" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </div>
</section>

<div class="modal" id="add-modal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content input-modal">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">添加礼品<a class="anchorjs-link"><span class="anchorjs-icon"></span></a></h4>
      </div>
      <div class="modal-body">
        <form enctype="multipart/form-data" method="post" id="add-gift-form">
          <input type="text" id="giftName" class="form-control" placeholder="名称">
          <input type="number" id="giftCredit" class="form-control" placeholder="积分(整数)">
          <textarea type="text" id="giftDes" class="form-control" placeholder="描述" rows="3"></textarea>
          <label>礼品图片：</label>
          <input type="file" id="giftPic">
        </form>
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary" id="add-gift-btn">确定</button>
        <div class="clear"></div>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="change-modal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">编辑礼品<a class="anchorjs-link"><span class="anchorjs-icon"></span></a></h4>
      </div>
      <div class="modal-body">
        <input type="text">
        <input type="">
        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        <button type="button" class="btn btn-primary">确定</button>
        <div class="clear"></div>
      </div>
    </div>
  </div>
</div>

</body>
<script src="js/jquery-2.1.3.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/base.js"></script>
<script>
  $(document).ready(function(){
    //判断是否登录
    isLogin();
  })

  var giftList = null;
  //获取礼品列表
    $.ajax({
      url: baseUrl + 'getPresent',
      xhrFields: {
        withCredentials: true
      },
      type: 'POST',
      dataType: 'json',
      data: {
        page:1,
        size:10
      },
      success: function (data) {
        var obj = eval(data);
        if (obj['success']) {
          giftList = obj['data'];
          for( var i = 0; i < obj['data'].length; i++ ) {
            var giftBox = ' <div class="gift-box"> <img class="gift-img col-md-5" src="http://'
              + obj['data'][i].pictureUrl
              + '"> <div class="col-md-7 gift-info"> <p>名称：'
              + obj['data'][i].name
              + '</p> <p>积分：'
              + obj['data'][i].credit
              + '</p> <p class="gift-dsp">描述：'
              + obj['data'][i].description
              + '</p> <div class="gift-btn"> <input type="button" class="btn btn-danger" value="删除" data-toggle="modal" data-target="#change-modal" data-id="'
              + obj['data'][i].id
              + '"/> <input type="button" class="btn btn-success" value="编辑" data-toggle="modal" data-target="#change-modal" data-id="'
              + obj['data'][i].id
              + '"/> <div class="clear"></div> </div> </div> <div class="clear"></div> </div>';
            $('#gift-container').append(giftBox);
          }
        } else {
          alert(obj['msg']);
        }
      }
    });

  $('.btn-danger').click(function(){
    alert(this.dataset.id)

  })

  $('.btn-success').click(function(){
    alert(this.dataset.id)
  })

  $('#add-gift-btn').click(function(){
    if ( $('#giftName').val() == '' ) {
      alert('礼品名称不能为空');
    } else if ( $('#giftCredit').val() == '' ) {
      alert('礼品积分不能为空');
    } else if ( $('#giftDes').val() == '' ) {
      alert('礼品描述不能为空');
    } else if ( $('#giftPic').val() == '' ) {
      alert('礼品图片不能为空');
    } else {
      alert(baseUrl + 'addPresent');
      $('add-gift-form').action= baseUrl + 'addPresent';
      $('add-gift-form').submit();
    }
  })
</script>
</body>
</html>